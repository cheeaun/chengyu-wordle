var he=Object.defineProperty,ue=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var te=(t,l,o)=>l in t?he(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,H=(t,l)=>{for(var o in l||(l={}))fe.call(l,o)&&te(t,o,l[o]);if(ee)for(var o of ee(l))pe.call(l,o)&&te(t,o,l[o]);return t},P=(t,l)=>ue(t,me(l));import{j as ge,a as we,F as ye,l as C,y as S,d as A,p as be,S as ve}from"./vendor.cfb7979a.js";import{i as ke}from"./all-idioms.effcc4de.js";import{d as Ce}from"./game-idioms.4b614f9d.js";const Ie=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))m(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const b of r.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&m(b)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function m(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}};Ie();const e=ge,c=we,D=ye,I=t=>be(t,{segment:!0,group:!0}).flat().join(" ").trim(),Se=ke.split(`
`),k=Ce.slice(1).map(t=>({id:t[0],idiom:t[1]})),R=4,T=20,z=6,F="cywd-";window.clearGames=()=>{for(let t=0;t<localStorage.length;t++){const l=localStorage.key(t);l.startsWith(F)&&localStorage.removeItem(l)}};window.allGames=()=>{const t=new Map;for(let l=0;l<localStorage.length;l++){const o=localStorage.key(l);if(o.startsWith(F)){const m=JSON.parse(localStorage.getItem(o));t.set(o.replace(F,""),m)}}return t};const ne=(t,l)=>{const o=typeof l=="string"?l.split(""):l,m=typeof t=="string"?t.split(""):t,i=o.length,r=Array.from({length:i},()=>"\u2B1C");if(i!==m.length)throw new Error("idioms must have the same length");const b=[];for(let y=0;y<i;y++){const u=o[y],p=m[y];u===p&&(r[y]="\u{1F7E9}",b.push(y))}const w=[];for(let y=0;y<i;y++){const u=o[y],p=m[y];if(u!==p){const h=m.indexOf(u);h!==-1&&!b.includes(h)&&!w.includes(h)&&(r[y]="\u{1F7E7}",w.push(h))}}return r};window.getIdiomStates=ne;const re=t=>{if(t.some(i=>!!i.length&&i.every(r=>r==="\u{1F7E9}")))return"won";const o=t[t.length-1];return!!o.length&&o.every(i=>i!=="\u{1F7E9}")?"lost":null},oe=()=>Array.from({length:z},()=>({v:Array.from({length:R},()=>""),s:!1})),K=(t,l,o,m=0)=>{var y;let i=l||new Set;i.add(t);let r=o||new Set;const b=t.split("");b.forEach(u=>r.add(u));let w=0;e:for(let u=0;u<k.length;u++){const p=b[(u+1)%R],h=k.find(({idiom:E})=>!i.has(E)&&E.includes(p));if(h){for(let E=0;E<h.idiom.length;E++)if(r.add(h.idiom[E]),r.size>=T)break e;i.add(h.idiom),w=0}else{if(w>=R+1)break e;w+=1}}if(r.size<T||i.size<z){const u=[...i][++m];if(u){const{passedIdioms:p,keys:h}=K(u,i,r,m);i=p,r=h}}if(r.size<T||i.size<z){const u=k[Math.floor(Math.random()*k.length)].idiom;if(u){const{passedIdioms:p,keys:h}=K(u,i,r,0);i=p,r=h}}if(r.size<T||i.size<z){const u=(y=k.find(p=>p.idiom===t))==null?void 0:y.id;console.error(u,{possibleIdioms:i.size,keySize:r.size,consecutiveFailures:w})}return{passedIdioms:i,keys:r}},W=t=>c("svg",P(H({viewBox:"0 0 20 20",fill:"currentColor"},t),{children:[e("title",{children:"\u25B6\uFE0F"}),e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})]})),ie=t=>c("svg",P(H({viewBox:"0 0 24 24"},t),{children:[e("title",{children:"\u2716\uFE0F"}),e("path",{fill:"currentColor",d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})]})),se=new Date(2022,1,1),j=()=>{const l=new Date().setHours(0,0,0,0)-se,o=Math.floor(l/(1e3*60*60*24));return k[Math.max(0,o%k.length)]},Ee=()=>{let t=new Date().setHours(0,0,0,0)+24*60*60*1e3;const l=new Date(+se+24*60*60*1e3);t<l&&(t=l);const[o,m]=C("00"),[i,r]=C("00"),[b,w]=C("00"),[y,u]=C(!1);return S(()=>{const p=setInterval(()=>{const h=t-new Date;if(h<=0){u(!0),clearInterval(p);return}m(Math.floor(h/(1e3*60*60)).toString().padStart(2,"0")),r(Math.floor(h/(1e3*60)%60).toString().padStart(2,"0")),w(Math.floor(h/1e3%60).toString().padStart(2,"0"))},1e3);return()=>clearInterval(p)},[]),y?e("a",{href:"./",children:"Now!"}):c("time",{class:"countdown",children:[o,":",i,":",b]})},le=({code:t,url:l})=>t&&e("input",{readOnly:!0,value:t,class:"idiom-code",onClick:o=>{o.target.focus(),o.target.select(),navigator.clipboard.writeText(l||t).then(()=>{alert("Copied URL to clipboard")}).catch(m=>{})}});function xe(){var V;const[t,l]=C(k.find(n=>n.id===location.hash.slice(1))||j());S(()=>{window.addEventListener("hashchange",()=>{l(k.find(n=>n.id===location.hash.slice(1))||j())})},[]);const[o,m]=C(((V=JSON.parse(localStorage.getItem(`${F}${t.id}`)))==null?void 0:V.board)||oe());S(()=>{const n=localStorage.getItem(`${F}${t.id}`);m(n?JSON.parse(n).board:oe())},[t.id]);const i=A(()=>o.map((n,s)=>n.s?ne(t.idiom,n.v):[]),[o]);S(()=>{o&&o.some(n=>n.v.some(s=>s))&&localStorage.setItem(`${F}${t.id}`,JSON.stringify({board:o,gameState:re(i)}))},[i]);const[r,b]=C(null);S(()=>{b(null),fetch(`https://baidu-hanyu-idiom.cheeaun.workers.dev/?wd=${t.idiom}`).then(n=>n.json()).then(n=>{n.definition&&b(n.definition)})},[t.idiom]);const w=(o==null?void 0:o.findIndex(n=>n.s===!1))||0,[y,u]=C(!1),[p,h]=C(!1),[E,J]=C(!1),$=A(()=>{const{passedIdioms:n,keys:s}=K(t.idiom),a=[...n].map(d=>`${d} (${I(d)})`).sort((d,f)=>d.localeCompare(f,"zh"));return console.log(`POSSIBLE IDOMS [${t.id}] (${s.size} keys):
${a.map((d,f)=>`${f+1}. ${d}`).join(`
`)}

\u{1F6A8}SPOILER\u{1F6A8} Type 'ANSWER' to see the answer.
`),window.ANSWER=`${t.idiom} (${I(t.idiom)})`,[...s].sort((d,f)=>d.localeCompare(f,"zh"))},[t.idiom]),_=(n,s=!1)=>{if(!o[w]||v)return;const a=[...o];let d=a[w].v.findIndex(f=>f==="");s&&(d===-1?d=3:d--),d!==-1&&(a[w].v[d]=n,m(a))},L=new Set,N=new Set,G=new Set;o.forEach((n,s)=>{!n.s||n.v.forEach((a,d)=>{const f=i[s][d];f==="\u{1F7E9}"?L.add(a):f==="\u{1F7E7}"?N.add(a):f==="\u2B1C"&&G.add(a)})});const X=()=>{if(v)return;console.log("handleEnter"),u(!1);const n=o[w],s=n.v.join(""),a=Se.includes(s);a?(n.s=!0,m([...o])):setTimeout(()=>{u(!0)},10),console.log({currentIdiom:s,valid:a})},v=A(()=>re(i),[i]);S(()=>{h(v==="won"?"won":v==="lost"?"lost":!1)},[v]);const U=()=>{if(v)return;const n=[...o],s=n[w];if(!s||s.s)return;let a=-1;for(let d=s.v.length-1;d>=0;d--)if(s.v[d]!==""){a=d;break}a!==-1&&(s.v[a]="",m(n))};S(()=>{document.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),n.stopPropagation())})},[]),S(()=>{const n=s=>{if(v||s.metaKey||s.ctrlKey||!s.key)return;const a=s.key.toLowerCase();if(a==="enter")s.preventDefault(),s.stopPropagation(),X();else if(a==="backspace")s.preventDefault(),U();else if(/^arrow(left|right)/i.test(a)){const f=[...o[w].v].reverse().find(g=>g!=="");if(f){const g=I(f)[0],x=$.filter(de=>I(de)[0]===g);if(x.length<=1)return;const Q=x.indexOf(f),Z=a==="arrowright"?x[(Q+1)%x.length]:x[(Q+x.length-1)%x.length];Z&&_(Z,!0)}}else{const d=$.find(f=>I(f)[0].localeCompare(a,"en",{sensitivity:"base"})===0);d&&(s.preventDefault(),_(d))}};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[$,w,v]);const O=location.origin+location.pathname+"#"+t.id,Y=i.map(n=>n.join("")).join(`
`).trim(),ce=v==="won"?Y.split(`
`).length:"X",M=`${`Chengyu Wordle [${t.id}] ${ce}/6

${Y}`}

${O}`,q=A(()=>{const n=[],s=t.idiom.split(""),a=$.filter(g=>!s.includes(g)&&!G.has(g)).slice(0,-1).slice(0,3).map(g=>`\u274C The letter ${g} (${I(g)}) is NOT in the idiom.`).sort(()=>Math.random()-.5);n.push(...a),(r==null?void 0:r.zh)&&s.filter(g=>r.zh.includes(g)).length<=2&&n.push(`\u2139\uFE0F ${r.zh}`),(r==null?void 0:r.en)&&n.push(`\u2139\uFE0F ${r.en}`);const d=s.filter(g=>!L.has(g)&&!N.has(g)).slice(0,-1).map(g=>`\u2705 The letter ${g} (${I(g)}) is in the idiom.`).sort(()=>Math.random()-.5);n.push(...d);const f=s.map(g=>I(g)[0]).join("").normalize("NFD").replace(/[\u0300-\u036f]/g,"");return n.push(`\u2728 Abbreviated pinyin: ${f}`),n},[L,t.idiom,r]),B=C(0);S(()=>{B.current=0},[t.idiom]);const ae=()=>{if(v)return;const n=q[B.current];B.current=(B.current+1)%q.length,alert(n)};return c(D,{children:[c("header",{children:[e("button",{type:"button",onClick:()=>{J(!0)},children:c("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e("title",{children:"\u2139\uFE0F"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),c("h1",{children:["Chengyu Wordle ",e("sup",{children:"beta"})]}),e("button",{type:"button",onClick:()=>{h(v||"play")},children:"Play"})]}),e("div",{id:"board",children:o.map((n,s)=>e("div",{className:`row ${w===s&&y?"error":""} ${w===s?"current":""}`,children:n.v.map((a,d)=>{var f;return e("div",{className:`letter ${a!=null?a:"lettered"} ${(f=i[s][d])!=null?f:""}`,children:c("ruby",{children:[a||e("span",{style:{opacity:0},children:"\u4E00"}),e("rp",{children:"("}),e("rt",{children:I(a)||e(D,{children:"\xA0"})}),e("rp",{children:")"})]})},d)})},s))}),e("div",{id:"keyboard",children:c("div",{class:"inner",children:[e("div",{class:"keys",children:$.map((n,s)=>e("button",{class:`${L.has(n)?"\u{1F7E9}":""} ${N.has(n)?"\u{1F7E7}":""} ${G.has(n)?"\u2B1C":""}`,type:"button",tabIndex:-1,onClick:()=>{_(n)},children:c("ruby",{children:[n,e("rp",{children:"("}),e("rt",{children:I(n)}),e("rp",{children:")"})]})}))}),c("div",{class:"row",children:[e("button",{type:"button",onClick:X,tabIndex:-1,children:"Enter"}),e("button",{type:"button",class:"stuck",onClick:ae,children:"I'm stuck"}),e("button",{type:"button",onClick:U,tabIndex:-1,children:e("svg",{height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7.07L2.4 12l4.66-7H22v14zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z"})})})]})]})}),c("div",{id:"modal",class:p?"appear":"",onClick:n=>{n.target===n.currentTarget&&h(null)},children:[e(ie,{height:"24",width:"24",class:"close",onClick:()=>{h(null)}}),c("div",{class:"content",children:[e("h2",{children:p==="won"?"\u{1F389}\u{1F389}\u{1F389}":p==="lost"?"\u{1F62D}\u{1F62D}\u{1F62D}":"\u{1F47E}\u{1F47E}\u{1F47E}"}),p==="play"&&e("p",{children:e(le,{code:t.id,url:O})}),/(won|lost)/i.test(p)&&c(D,{children:[c("p",{children:[e("b",{class:"answer",children:c("ruby",{children:[t.idiom,e("rp",{children:"("}),e("rt",{children:I(t.idiom)}),e("rp",{children:")"})]})}),c("div",{class:"definition",children:[r==null?void 0:r.zh,(r==null?void 0:r.zh)&&(r==null?void 0:r.en)&&e("br",{}),r==null?void 0:r.en]}),c("small",{children:[(r==null?void 0:r.zh)||(r==null?void 0:r.en)?"Source:":"\u{1F4D6}"," ",e("a",{href:`https://hanyu.baidu.com/s?wd=${t.idiom}&from=zici`,target:"_blank",children:"Baidu"})]})]}),e("div",{class:"results",children:M}),c("button",{id:"share",onClick:async()=>{try{await navigator.share({text:M})}catch{try{await navigator.clipboard.writeText(M),alert("Copied results to clipboard")}catch{}}},children:["Share"," ",e("svg",{height:"16",width:"16",viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})})]}),"\xA0\xA0",e("a",{class:"button tweet",href:`https://twitter.com/intent/tweet?text=${encodeURIComponent(M)}`,target:"_blank",children:c("svg",{height:"16",width:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[e("title",{children:"Tweet"}),e("path",{fill:"currentColor",d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})]})}),"\xA0\xA0",e(le,{code:t.id,url:O})]}),c("div",{class:"footer",children:[/won|lost/i.test(v)&&j().id===t.id&&e("p",{children:c("big",{children:["Next idiom:"," ",e("b",{children:e(Ee,{})})]})}),c("div",{children:[j().id!==t.id&&c(D,{children:[c("a",{href:"./",class:"button",children:[e(W,{width:20,height:20})," Play today's game!"]}),e("br",{})]}),c("button",{type:"button",onClick:()=>{if(confirm("Are you sure you want to start a new random game?")){const s=Math.round(Math.random()*(k.length-1)),a=k[s];location.hash=`#${a.id}`,h(null)}},children:[e(W,{width:20,height:20})," Random"]})," ",c("button",{type:"button",onClick:()=>{let n=prompt("Enter idiom ID/URL:");try{n=new URL(n).hash.slice(1)}catch{}if(n){const s=k.find(a=>a.id===n);s?(location.hash=`#${s.id}`,h(null)):alert("Invalid idiom ID")}},children:[e(W,{width:20,height:20})," Choose"]})]})]})]})]}),c("div",{id:"info-modal",class:E?"appear":"",children:[e(ie,{height:"24",width:"24",class:"close",onClick:()=>{J(!1)}}),c("div",{class:"content",children:[e("h2",{children:"How to play"}),c("p",{children:["Guess the idiom in ",z," tries."]}),e("p",{children:"Each guess must be a valid 4-letter idiom. Hit the enter button to submit."}),e("p",{children:"After each guess, the color of the tiles will change to show how close your guess was to the idiom."}),c("ul",{children:[e("li",{children:"\u{1F7E9}\u2B1C\u2B1C\u2B1C Green = correct spot"}),e("li",{children:"\u2B1C\u{1F7E7}\u2B1C\u2B1C Yellow = wrong spot"}),c("li",{children:["\u2B1C\u2B1C",e("span",{style:{opacity:.5},children:"\u2B1B"}),"\u2B1C Gray = not in any spot"]})]}),e("h2",{children:"About"}),c("p",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/",target:"_blank",children:"Built"})," ","by"," ",e("a",{href:"https://cheeaun.com",target:"_blank",children:"Chee Aun"}),"."," ",e("a",{href:"https://www.powerlanguage.co.uk/wordle/",target:"_blank",children:"Wordle"})," ","\xA9\uFE0F"," ",e("a",{href:"https://powerlanguage.co.uk/",target:"_blank",children:"Josh Wardle"}),"."]}),e("h2",{children:"Feedback channels"}),c("ul",{children:[e("li",{children:e("a",{href:"https://t.me/+ykuhfiImLd1kNjk1",target:"_blank",children:"Telegram group"})}),c("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/discussions",target:"_blank",children:"GitHub Discussions"}),"(for developers)"]}),c("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/issues",target:"_blank",children:"GitHub Issues"})," ","(for bugs)"]}),e("li",{children:e("a",{href:"https://twitter.com/cheeaun",target:"_blank",children:"@cheeaun on Twitter"})}),e("li",{children:e("a",{href:"https://t.me/cheeaun",target:"_blank",children:"@cheeaun on Telegram"})})]}),e("h2",{children:"Debugging"}),e("button",{type:"button",onClick:()=>{confirm("Are you sure?")&&(localStorage.removeItem(F+t.id),location.reload())},children:"Reset current idiom game"}),"\xA0",e("button",{type:"button",onClick:()=>{confirm("Are you sure?")&&(clearGames(),location.reload())},children:"Clear database"})]})]})]})}ve(e(xe,{}),document.getElementById("app"));
//# sourceMappingURL=index.60cc2983.js.map
