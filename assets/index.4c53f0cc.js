var te=Object.defineProperty,ne=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var J=(n,l,o)=>l in n?te(n,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[l]=o,z=(n,l)=>{for(var o in l||(l={}))oe.call(l,o)&&J(n,o,l[o]);if(R)for(var o of R(l))ie.call(l,o)&&J(n,o,l[o]);return n},M=(n,l)=>ne(n,re(l));import{j as se,a as le,F as ce,l as F,y as S,d as X,p as ae,S as de}from"./vendor.cfb7979a.js";import{i as he}from"./all-idioms.effcc4de.js";import{d as ue}from"./game-idioms.4b614f9d.js";const fe=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&h(p)}).observe(document,{childList:!0,subtree:!0});function o(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function h(r){if(r.ep)return;r.ep=!0;const c=o(r);fetch(r.href,c)}};fe();const e=se,a=le,A=ce,I=n=>ae(n,{segment:!0,group:!0}).flat().join(" ").trim(),pe=he.split(`
`),g=ue.slice(1).map(n=>({id:n[0],idiom:n[1]})),_=4,$=20,B=6;window.clearGames=()=>{for(let n=0;n<localStorage.length;n++){const l=localStorage.key(n);l.startsWith("cywd-")&&localStorage.removeItem(l)}};window.allGames=()=>{const n=new Map;for(let l=0;l<localStorage.length;l++){const o=localStorage.key(l);if(o.startsWith("cywd-")){const h=JSON.parse(localStorage.getItem(o));n.set(o.replace("cywd-",""),h)}}return n};const q=n=>{const l=[...n].reverse(),o=l.findIndex(r=>r.some(c=>c.v)),h=l[o];if(h){const r=h.every(p=>p.s==="correct");if(r)return"won";const c=h.every(p=>!!p.s);if(o===0&&!r&&c)return"lost"}return null},V=()=>Array.from({length:B},()=>Array.from({length:_},()=>({v:"",s:null}))),j=(n,l,o,h=0)=>{var y;let r=l||new Set;r.add(n);let c=o||new Set;const p=n.split("");p.forEach(f=>c.add(f));let w=0;e:for(let f=0;f<g.length;f++){const v=p[(f+1)%_],m=g.find(({idiom:b})=>!r.has(b)&&b.includes(v));if(m){for(let b=0;b<m.idiom.length;b++)if(c.add(m.idiom[b]),c.size>=$)break e;r.add(m.idiom),w=0}else{if(w>=_+1)break e;w+=1}}if(c.size<$||r.size<B){const f=[...r][++h];if(f){const{passedIdioms:v,keys:m}=j(f,r,c,h);r=v,c=m}}if(c.size<$||r.size<B){const f=g[Math.floor(Math.random()*g.length)].idiom;if(f){const{passedIdioms:v,keys:m}=j(f,r,c,0);r=v,c=m}}if(c.size<$||r.size<B){const f=(y=g.find(v=>v.idiom===n))==null?void 0:y.id;console.log(f,{possibleIdioms:r.size,keySize:c.size,consecutiveFailures:w})}return{passedIdioms:r,keys:c}},Y=n=>a("svg",M(z({viewBox:"0 0 20 20",fill:"currentColor"},n),{children:[e("title",{children:"\u25B6\uFE0F"}),e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})]})),Q=n=>a("svg",M(z({viewBox:"0 0 24 24"},n),{children:[e("title",{children:"\u2716\uFE0F"}),e("path",{fill:"currentColor",d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})]}));function me(){var K;const[n,l]=F(g.find(t=>t.id===location.hash.slice(1))||g[0]);S(()=>{window.addEventListener("hashchange",()=>{l(g.find(t=>t.id===location.hash.slice(1))||g[0])})},[]);const[o,h]=F(((K=JSON.parse(localStorage.getItem(`cywd-${n.id}`)))==null?void 0:K.board)||V());S(()=>{const t=localStorage.getItem(`cywd-${n.id}`);h(t?JSON.parse(t).board:V())},[n.id]),S(()=>{o&&o.some(t=>t.some(i=>i.v))&&localStorage.setItem(`cywd-${n.id}`,JSON.stringify({board:o,gameState:q(o)}))},[o]);const r=(o==null?void 0:o.findIndex(t=>t.some(i=>!i.s)))||0,[c,p]=F(!1),[w,y]=F(!1),[f,v]=F(!1),m=X(()=>{const{passedIdioms:t,keys:i}=j(n.idiom),s=[...t].map(d=>`${d} (${I(d)})`).sort((d,u)=>d.localeCompare(u,"zh"));return console.log(`POSSIBLE IDOMS [${n.id}] (${i.size} keys):
${s.map((d,u)=>`${u+1}. ${d}`).join(`
`)}

\u{1F6A8}SPOILER\u{1F6A8} Type 'ANSWER' to see the answer.
`),window.ANSWER=`${n.idiom} (${I(n.idiom)})`,[...i].sort((d,u)=>d.localeCompare(u,"zh"))},[n.idiom]),b=(t,i=!1)=>{if(!o[r]||k)return;const s=[...o];let d=s[r].findIndex(E=>E.v==="");i&&(d===-1?d=3:d--);const u=s[r][d];u&&(u.v=t,h(s))},U=o.flat(),D=[],G=[],T=[];U.forEach(t=>{t.s==="correct"?D.push(t.v):t.s==="present"?G.push(t.v):t.s==="absent"&&T.push(t.v)});const N=()=>{if(k)return;console.log("handleEnter"),p(!1);const t=o[r].map(s=>s.v).join(""),i=pe.includes(t);i?(o[r].forEach((s,d)=>{n.idiom[d]===s.v?s.s="correct":n.idiom.split("").includes(s.v)?s.s="present":s.s="absent"}),h([...o])):setTimeout(()=>{p(!0)},10),console.log({currentIdiom:t,valid:i})},k=X(()=>q(o),[o]);S(()=>{y(k==="won"?"won":k==="lost"?"lost":!1)},[k]);const O=()=>{if(k)return;const t=[...o];if(!t[r])return;const i=[...t[r]].reverse().find(s=>s.v!==""&&s.s===null);i&&(i.v="",h(t))};S(()=>{document.addEventListener("keydown",t=>{t.key==="Enter"&&(t.preventDefault(),t.stopPropagation())})},[]),S(()=>{const t=i=>{if(k||i.metaKey||i.ctrlKey||!i.key)return;const s=i.key.toLowerCase();if(s==="enter")i.preventDefault(),i.stopPropagation(),N();else if(s==="backspace")i.preventDefault(),O();else if(/^arrow(left|right)/i.test(s)){const d=[...o[r]].reverse().find(E=>E.v!==""),u=d==null?void 0:d.v;if(u){const E=I(u)[0],C=m.filter(ee=>I(ee)[0]===E);if(C.length<=1)return;const W=C.indexOf(u),H=s==="arrowright"?C[(W+1)%C.length]:C[(W+C.length-1)%C.length];H&&b(H,!0)}}else{const d=m.find(u=>I(u)[0].localeCompare(s,"en",{sensitivity:"base"})===0);d&&(i.preventDefault(),b(d))}};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[m,r,k]);const x=location.origin+location.pathname+"#"+n.id,P=o.map(t=>t.some(i=>!!i.v)?`
${t.map(({s:i})=>({correct:"\u{1F7E9}",present:"\u{1F7E8}",absent:"\u2B1C"})[i]).join("")}`:"").join("").trim(),Z=k==="won"?P.split(`
`).length:"X",L=`Chengyu Wordle [${n.id}] ${Z}/6

${P}

${x}`;return a(A,{children:[a("header",{children:[e("button",{type:"button",onClick:()=>{v(!0)},children:a("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e("title",{children:"\u2139\uFE0F"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),a("h1",{children:["Chengyu Wordle ",e("sup",{children:"beta"})]}),e("button",{type:"button",onClick:()=>{y(k||"play")},children:"Play"})]}),e("div",{id:"board",children:o.map((t,i)=>e("div",{className:`row ${r===i&&c?"error":""} ${r===i?"current":""}`,children:t.map((s,d)=>{var u;return e("div",{className:`letter ${s.v?"lettered":""} ${(u=s.s)!=null?u:""}`,children:a("ruby",{children:[s.v||e("span",{style:{opacity:0},children:"\u4E00"}),e("rp",{children:"("}),e("rt",{children:I(s.v)||e(A,{children:"\xA0"})}),e("rp",{children:")"})]})},d)})},i))}),e("div",{id:"keyboard",children:a("div",{class:"inner",children:[e("div",{class:"keys",children:m.map((t,i)=>e("button",{class:`${D.includes(t)?"correct":""} ${G.includes(t)?"present":""} ${T.includes(t)?"absent":""}`,type:"button",tabIndex:-1,onClick:()=>{b(t)},children:a("ruby",{children:[t,e("rp",{children:"("}),e("rt",{children:I(t)}),e("rp",{children:")"})]})}))}),a("div",{class:"row",children:[e("button",{type:"button",onClick:N,tabIndex:-1,children:"Enter"}),e("button",{type:"button",onClick:O,tabIndex:-1,children:e("svg",{height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7.07L2.4 12l4.66-7H22v14zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z"})})})]})]})}),a("div",{id:"modal",class:w?"appear":"",onClick:t=>{t.target===t.currentTarget&&y(null)},children:[e(Q,{height:"24",width:"24",class:"close",onClick:()=>{y(null)}}),a("div",{class:"content",children:[e("h2",{children:w==="won"?"\u{1F389}\u{1F389}\u{1F389}":w==="lost"?"\u{1F62D}\u{1F62D}\u{1F62D}":"\u{1F47E}\u{1F47E}\u{1F47E}"}),w==="play"&&a("a",{href:x,children:["\u{1F517} ",location.host+"/#"+n.id]}),/(won|lost)/i.test(w)&&a(A,{children:[a("p",{children:[e("b",{class:"answer",children:a("ruby",{children:[n.idiom,e("rp",{children:"("}),e("rt",{children:I(n.idiom)}),e("rp",{children:")"})]})}),e("br",{})," ",a("small",{children:[a("a",{href:x,children:["\u{1F517} ",n.id]}),"\xA0\xA0",e("a",{href:`https://cc-cedict.org/editor/editor.php?handler=QueryDictionary&querydictionary_search=${n.idiom}`,target:"_blank",children:"\u{1F4D6} CC-CEDICT"})]})]}),e("div",{class:"results",children:L}),a("button",{id:"share",onClick:async()=>{try{await navigator.share({text:L})}catch{try{await navigator.clipboard.writeText(L),alert("Copied results to clipboard")}catch{}}},children:["Share"," ",e("svg",{height:"16",width:"16",viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})})]})]}),a("p",{children:[a("button",{type:"button",onClick:()=>{if(confirm("Are you sure you want to start a new random game?")){const i=Math.round(Math.random()*(g.length-1)),s=g[i];location.hash=`#${s.id}`,y(null)}},children:[e(Y,{width:20,height:20})," Random"]})," ",a("button",{type:"button",onClick:()=>{const t=prompt("Enter idiom ID:");if(t){const i=g.find(s=>s.id===t);i?(location.hash=`#${i.id}`,y(null)):alert("Invalid idiom ID")}},children:[e(Y,{width:20,height:20})," Choose"]})]})]})]}),a("div",{id:"info-modal",class:f?"appear":"",children:[e(Q,{height:"24",width:"24",class:"close",onClick:()=>{v(!1)}}),a("div",{class:"content",children:[e("h2",{children:"How to play"}),e("p",{children:"Guess the idiom in 6 tries."}),e("p",{children:"Each guess must be a valid 4-letter idiom. Hit the enter button to submit."}),e("p",{children:"After each guess, the color of the tiles will change to show how close your guess was to the idiom."}),a("ul",{children:[e("li",{children:"\u{1F7E9}\u2B1C\u2B1C\u2B1C Green = correct spot"}),e("li",{children:"\u2B1C\u{1F7E8}\u2B1C\u2B1C Yellow = wrong spot"}),a("li",{children:["\u2B1C\u2B1C",e("span",{style:{opacity:.5},children:"\u2B1B"}),"\u2B1C Gray = not in any spot"]})]}),e("h2",{children:"About"}),a("p",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/",target:"_blank",children:"Built"})," ","by"," ",e("a",{href:"https://cheeaun.com",target:"_blank",children:"Chee Aun"}),"."," ",e("a",{href:"https://www.powerlanguage.co.uk/wordle/",target:"_blank",children:"Wordle"})," ","\xA9\uFE0F"," ",e("a",{href:"https://powerlanguage.co.uk/",target:"_blank",children:"Josh Wardle"}),"."]}),e("h2",{children:"Feedback channels"}),a("ul",{children:[e("li",{children:e("a",{href:"https://t.me/+ykuhfiImLd1kNjk1",target:"_blank",children:"Telegram group"})}),a("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/discussions",target:"_blank",children:"GitHub Discussions"}),"(for developers)"]}),a("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/issues",target:"_blank",children:"GitHub Issues"})," ","(for bugs)"]}),e("li",{children:e("a",{href:"https://twitter.com/cheeaun",target:"_blank",children:"@cheeaun on Twitter"})}),e("li",{children:e("a",{href:"https://t.me/cheeaun",target:"_blank",children:"@cheeaun on Telegram"})})]})]})]})]})}de(e(me,{}),document.getElementById("app"));
//# sourceMappingURL=index.4c53f0cc.js.map
