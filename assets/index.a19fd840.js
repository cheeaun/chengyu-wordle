var ce=Object.defineProperty,ae=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var ee=(t,c,r)=>c in t?ce(t,c,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[c]=r,N=(t,c)=>{for(var r in c||(c={}))he.call(c,r)&&ee(t,r,c[r]);if(Z)for(var r of Z(c))ue.call(c,r)&&ee(t,r,c[r]);return t},H=(t,c)=>ae(t,de(c));import{j as fe,a as me,F as pe,l as I,y as F,d as B,p as ge,s as ye,S as we}from"./vendor.e0354cd7.js";import{i as be}from"./all-idioms.effcc4de.js";import{d as ve}from"./game-idioms.4b614f9d.js";const ke=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const w of s.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&m(w)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function m(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}};ke();const e=fe,l=me,L=pe,C=t=>ge(t,{segment:!0,group:!0}).flat().join(" ").trim(),Se=be.split(`
`),S=ve.slice(1).map(t=>({id:t[0],idiom:t[1]})),O=4,z=20,x=6,$="cywd-";window.clearGames=()=>{for(let t=0;t<localStorage.length;t++){const c=localStorage.key(t);c.startsWith($)&&localStorage.removeItem(c)}};window.allGames=()=>{const t=new Map;for(let c=0;c<localStorage.length;c++){const r=localStorage.key(c);if(r.startsWith($)){const m=JSON.parse(localStorage.getItem(r));t.set(r.replace($,""),m)}}return t};const te=(t,c)=>{const r=typeof c=="string"?c.split(""):c,m=typeof t=="string"?t.split(""):t,o=r.length,s=Array.from({length:o},()=>"\u2B1C");if(o!==m.length)throw new Error("idioms must have the same length");const w=[];for(let u=0;u<o;u++){const h=r[u],b=m[u];h===b&&(s[u]="\u{1F7E9}",w.push(u))}const y=[];for(let u=0;u<o;u++){const h=r[u],b=m[u];if(h!==b){const g=m.indexOf(h);g!==-1&&!w.includes(g)&&!y.includes(g)&&(s[u]="\u{1F7E7}",y.push(g))}}return s};window.getIdiomStates=te;const ne=t=>{if(t.some(o=>!!o.length&&o.every(s=>s==="\u{1F7E9}")))return"won";const r=t[t.length-1];return!!r.length&&r.every(o=>o!=="\u{1F7E9}")?"lost":null},oe=()=>Array.from({length:x},()=>({v:Array.from({length:O},()=>""),s:!1})),P=(t,c,r,m=0)=>{var u;let o=c||new Set;o.add(t);let s=r||new Set;const w=t.split("");w.forEach(h=>s.add(h));let y=0;e:for(let h=0;h<S.length;h++){const b=w[(h+1)%O],g=S.find(({idiom:v})=>!o.has(v)&&v.includes(b));if(g){for(let v=0;v<g.idiom.length;v++)if(s.add(g.idiom[v]),s.size>=z)break e;o.add(g.idiom),y=0}else{if(y>=O+1)break e;y+=1}}if(s.size<z||o.size<x){const h=[...o][++m];if(h){const{passedIdioms:b,keys:g}=P(h,o,s,m);o=b,s=g}}if(s.size<z||o.size<x){const h=S[Math.floor(Math.random()*S.length)].idiom;if(h){const{passedIdioms:b,keys:g}=P(h,o,s,0);o=b,s=g}}if(s.size<z||o.size<x){const h=(u=S.find(b=>b.idiom===t))==null?void 0:u.id;console.error(h,{possibleIdioms:o.size,keySize:s.size,consecutiveFailures:y})}return{passedIdioms:o,keys:s}},K=t=>l("svg",H(N({viewBox:"0 0 20 20",fill:"currentColor"},t),{children:[e("title",{children:"\u25B6\uFE0F"}),e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})]})),re=t=>l("svg",H(N({viewBox:"0 0 24 24"},t),{children:[e("title",{children:"\u2716\uFE0F"}),e("path",{fill:"currentColor",d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})]})),A=new Date(2022,1,1),R=()=>{const c=new Date().setHours(0,0,0,0)-A,r=Math.floor(c/(1e3*60*60*24));return S[Math.max(0,r%S.length)]},Ce=()=>{const t=new Date().setHours(0,0,0,0)+24*60*60*1e3;if(t<A){const y=Math.ceil((A-t)/(1e3*60*60*24));return l("time",{dateTime:A,children:[y," ",y===1?"day":"days"]})}const[c,r]=I("00"),[m,o]=I("00"),[s,w]=I("00");return F(()=>{const y=setInterval(()=>{const u=t-new Date;r(Math.floor(u/(1e3*60*60)).toString().padStart(2,"0")),o(Math.floor(u/(1e3*60)%60).toString().padStart(2,"0")),w(Math.floor(u/1e3%60).toString().padStart(2,"0"))},1e3);return()=>clearInterval(y)},[]),l("time",{class:"countdown",children:[c,":",m,":",s]})};function Ie(){var U;const[t,c]=I(S.find(n=>n.id===location.hash.slice(1))||R());F(()=>{window.addEventListener("hashchange",()=>{c(S.find(n=>n.id===location.hash.slice(1))||R())})},[]);const[r,m]=I(((U=JSON.parse(localStorage.getItem(`${$}${t.id}`)))==null?void 0:U.board)||oe());F(()=>{const n=localStorage.getItem(`${$}${t.id}`);m(n?JSON.parse(n).board:oe())},[t.id]);const o=B(()=>r.map((n,i)=>n.s?te(t.idiom,n.v):[]),[r]);F(()=>{r&&r.some(n=>n.v.some(i=>i))&&localStorage.setItem(`${$}${t.id}`,JSON.stringify({board:r,gameState:ne(o)}))},[o]);const s=(r==null?void 0:r.findIndex(n=>n.s===!1))||0,[w,y]=I(!1),[u,h]=I(!1),[b,g]=I(!1),v=B(()=>{const{passedIdioms:n,keys:i}=P(t.idiom),a=[...n].map(d=>`${d} (${C(d)})`).sort((d,f)=>d.localeCompare(f,"zh"));return console.log(`POSSIBLE IDOMS [${t.id}] (${i.size} keys):
${a.map((d,f)=>`${f+1}. ${d}`).join(`
`)}

\u{1F6A8}SPOILER\u{1F6A8} Type 'ANSWER' to see the answer.
`),window.ANSWER=`${t.idiom} (${C(t.idiom)})`,[...i].sort((d,f)=>d.localeCompare(f,"zh"))},[t.idiom]),D=(n,i=!1)=>{if(!r[s]||k)return;const a=[...r];let d=a[s].v.findIndex(f=>f==="");i&&(d===-1?d=3:d--),d!==-1&&(a[s].v[d]=n,m(a))},M=new Set,W=new Set,j=new Set;r.forEach((n,i)=>{!n.s||n.v.forEach((a,d)=>{const f=o[i][d];f==="\u{1F7E9}"?M.add(a):f==="\u{1F7E7}"?W.add(a):f==="\u2B1C"&&j.add(a)})});const J=()=>{if(k)return;console.log("handleEnter"),y(!1);const n=r[s],i=n.v.join(""),a=Se.includes(i);a?(n.s=!0,m([...r])):setTimeout(()=>{y(!0)},10),console.log({currentIdiom:i,valid:a})},k=B(()=>ne(o),[o]);F(()=>{h(k==="won"?"won":k==="lost"?"lost":!1)},[k]);const X=()=>{if(k)return;const n=[...r],i=n[s];if(!i||i.s)return;let a=-1;for(let d=i.v.length-1;d>=0;d--)if(i.v[d]!==""){a=d;break}a!==-1&&(i.v[a]="",m(n))};F(()=>{document.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),n.stopPropagation())})},[]),F(()=>{const n=i=>{if(k||i.metaKey||i.ctrlKey||!i.key)return;const a=i.key.toLowerCase();if(a==="enter")i.preventDefault(),i.stopPropagation(),J();else if(a==="backspace")i.preventDefault(),X();else if(/^arrow(left|right)/i.test(a)){const f=[...r[s].v].reverse().find(p=>p!=="");if(f){const p=C(f)[0],E=v.filter(le=>C(le)[0]===p);if(E.length<=1)return;const V=E.indexOf(f),Q=a==="arrowright"?E[(V+1)%E.length]:E[(V+E.length-1)%E.length];Q&&D(Q,!0)}}else{const d=v.find(f=>C(f)[0].localeCompare(a,"en",{sensitivity:"base"})===0);d&&(i.preventDefault(),D(d))}};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[v,s,k]);const _=location.origin+location.pathname+"#"+t.id,Y=o.map(n=>n.join("")).join(`
`).trim(),ie=k==="won"?Y.split(`
`).length:"X",T=`Chengyu Wordle [${t.id}] ${ie}/6

${Y}

${_}`,q=B(()=>{const n=[],i=t.idiom.split(""),a=v.filter(p=>!i.includes(p)&&!j.has(p)).slice(0,-1).slice(0,3).map(p=>`\u274C The letter ${p} (${C(p)}) is NOT in the idiom.`).sort(()=>Math.random()-.5);n.push(...a);const d=i.filter(p=>!M.has(p)).slice(0,-1).map(p=>`\u2705 The letter ${p} (${C(p)}) is in the idiom.`).sort(()=>Math.random()-.5);n.push(...d);const f=i.map(p=>C(p)[0]).join("").normalize("NFD").replace(/[\u0300-\u036f]/g,"");return n.push(`\u2728 Abbreviated pinyin: ${f}`),n},[M,t.idiom]),G=ye(0),se=()=>{if(k)return;const n=q[G.current];G.current=(G.current+1)%q.length,alert(n)};return l(L,{children:[l("header",{children:[e("button",{type:"button",onClick:()=>{g(!0)},children:l("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e("title",{children:"\u2139\uFE0F"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),l("h1",{children:["Chengyu Wordle ",e("sup",{children:"beta"})]}),e("button",{type:"button",onClick:()=>{h(k||"play")},children:"Play"})]}),e("div",{id:"board",children:r.map((n,i)=>e("div",{className:`row ${s===i&&w?"error":""} ${s===i?"current":""}`,children:n.v.map((a,d)=>{var f;return e("div",{className:`letter ${a!=null?a:"lettered"} ${(f=o[i][d])!=null?f:""}`,children:l("ruby",{children:[a||e("span",{style:{opacity:0},children:"\u4E00"}),e("rp",{children:"("}),e("rt",{children:C(a)||e(L,{children:"\xA0"})}),e("rp",{children:")"})]})},d)})},i))}),e("div",{id:"keyboard",children:l("div",{class:"inner",children:[e("div",{class:"keys",children:v.map((n,i)=>e("button",{class:`${M.has(n)?"\u{1F7E9}":""} ${W.has(n)?"\u{1F7E7}":""} ${j.has(n)?"\u2B1C":""}`,type:"button",tabIndex:-1,onClick:()=>{D(n)},children:l("ruby",{children:[n,e("rp",{children:"("}),e("rt",{children:C(n)}),e("rp",{children:")"})]})}))}),l("div",{class:"row",children:[e("button",{type:"button",onClick:J,tabIndex:-1,children:"Enter"}),e("button",{type:"button",class:"stuck",onClick:se,children:"I'm stuck"}),e("button",{type:"button",onClick:X,tabIndex:-1,children:e("svg",{height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7.07L2.4 12l4.66-7H22v14zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z"})})})]})]})}),l("div",{id:"modal",class:u?"appear":"",onClick:n=>{n.target===n.currentTarget&&h(null)},children:[e(re,{height:"24",width:"24",class:"close",onClick:()=>{h(null)}}),l("div",{class:"content",children:[e("h2",{children:u==="won"?"\u{1F389}\u{1F389}\u{1F389}":u==="lost"?"\u{1F62D}\u{1F62D}\u{1F62D}":"\u{1F47E}\u{1F47E}\u{1F47E}"}),u==="play"&&l("a",{href:_,children:["\u{1F517} ",location.host+"/#"+t.id]}),/(won|lost)/i.test(u)&&l(L,{children:[l("p",{children:[e("b",{class:"answer",children:l("ruby",{children:[t.idiom,e("rp",{children:"("}),e("rt",{children:C(t.idiom)}),e("rp",{children:")"})]})}),e("br",{})," ",l("small",{children:[l("a",{href:_,children:["\u{1F517} ",t.id]}),"\xA0\xA0",e("a",{href:`https://hanyu.baidu.com/s?wd=${t.idiom}&from=zici`,target:"_blank",children:"\u{1F4D6} Baidu"})]})]}),e("div",{class:"results",children:T}),l("button",{id:"share",onClick:async()=>{try{await navigator.share({text:T})}catch{try{await navigator.clipboard.writeText(T),alert("Copied results to clipboard")}catch{}}},children:["Share"," ",e("svg",{height:"16",width:"16",viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})})]})]}),l("div",{class:"footer",children:[/won|lost/i.test(k)&&e("p",{children:l("big",{children:["Next idiom:"," ",e("b",{children:e(Ce,{})})]})}),l("div",{children:[R().id!==t.id&&l(L,{children:[l("a",{href:"/",class:"button",children:[e(K,{width:20,height:20})," Play today's game!"]}),e("br",{})]}),l("button",{type:"button",onClick:()=>{if(confirm("Are you sure you want to start a new random game?")){const i=Math.round(Math.random()*(S.length-1)),a=S[i];location.hash=`#${a.id}`,h(null)}},children:[e(K,{width:20,height:20})," Random"]})," ",l("button",{type:"button",onClick:()=>{const n=prompt("Enter idiom ID:");if(n){const i=S.find(a=>a.id===n);i?(location.hash=`#${i.id}`,h(null)):alert("Invalid idiom ID")}},children:[e(K,{width:20,height:20})," Choose"]})]})]})]})]}),l("div",{id:"info-modal",class:b?"appear":"",children:[e(re,{height:"24",width:"24",class:"close",onClick:()=>{g(!1)}}),l("div",{class:"content",children:[e("h2",{children:"How to play"}),l("p",{children:["Guess the idiom in ",x," tries."]}),e("p",{children:"Each guess must be a valid 4-letter idiom. Hit the enter button to submit."}),e("p",{children:"After each guess, the color of the tiles will change to show how close your guess was to the idiom."}),l("ul",{children:[e("li",{children:"\u{1F7E9}\u2B1C\u2B1C\u2B1C Green = correct spot"}),e("li",{children:"\u2B1C\u{1F7E7}\u2B1C\u2B1C Yellow = wrong spot"}),l("li",{children:["\u2B1C\u2B1C",e("span",{style:{opacity:.5},children:"\u2B1B"}),"\u2B1C Gray = not in any spot"]})]}),e("h2",{children:"About"}),l("p",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/",target:"_blank",children:"Built"})," ","by"," ",e("a",{href:"https://cheeaun.com",target:"_blank",children:"Chee Aun"}),"."," ",e("a",{href:"https://www.powerlanguage.co.uk/wordle/",target:"_blank",children:"Wordle"})," ","\xA9\uFE0F"," ",e("a",{href:"https://powerlanguage.co.uk/",target:"_blank",children:"Josh Wardle"}),"."]}),e("h2",{children:"Feedback channels"}),l("ul",{children:[e("li",{children:e("a",{href:"https://t.me/+ykuhfiImLd1kNjk1",target:"_blank",children:"Telegram group"})}),l("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/discussions",target:"_blank",children:"GitHub Discussions"}),"(for developers)"]}),l("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/issues",target:"_blank",children:"GitHub Issues"})," ","(for bugs)"]}),e("li",{children:e("a",{href:"https://twitter.com/cheeaun",target:"_blank",children:"@cheeaun on Twitter"})}),e("li",{children:e("a",{href:"https://t.me/cheeaun",target:"_blank",children:"@cheeaun on Telegram"})})]}),e("h2",{children:"Debugging"}),e("button",{type:"button",onClick:()=>{confirm("Are you sure?")&&(localStorage.removeItem($+t.id),location.reload())},children:"Reset current idiom game"}),"\xA0",e("button",{type:"button",onClick:()=>{confirm("Are you sure?")&&(clearGames(),location.reload())},children:"Clear database"})]})]})]})}we(e(Ie,{}),document.getElementById("app"));
//# sourceMappingURL=index.a19fd840.js.map
