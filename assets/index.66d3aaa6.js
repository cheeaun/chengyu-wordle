var ne=Object.defineProperty,re=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var q=(t,l,o)=>l in t?ne(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,M=(t,l)=>{for(var o in l||(l={}))ie.call(l,o)&&q(t,o,l[o]);if(X)for(var o of X(l))se.call(l,o)&&q(t,o,l[o]);return t},A=(t,l)=>re(t,oe(l));import{j as le,a as ce,F as ae,l as S,y as I,d as _,p as de,S as he}from"./vendor.cfb7979a.js";import{i as ue}from"./all-idioms.effcc4de.js";import{d as fe}from"./game-idioms.4b614f9d.js";const me=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))m(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const w of i.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&m(w)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function m(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}};me();const e=le,a=ce,j=ae,C=t=>de(t,{segment:!0,group:!0}).flat().join(" ").trim(),pe=ue.split(`
`),y=fe.slice(1).map(t=>({id:t[0],idiom:t[1]})),D=4,B=20,$=6;window.clearGames=()=>{for(let t=0;t<localStorage.length;t++){const l=localStorage.key(t);l.startsWith("cywd-")&&localStorage.removeItem(l)}};window.allGames=()=>{const t=new Map;for(let l=0;l<localStorage.length;l++){const o=localStorage.key(l);if(o.startsWith("cywd-")){const m=JSON.parse(localStorage.getItem(o));t.set(o.replace("cywd-",""),m)}}return t};const Y=(t,l)=>{const o=typeof l=="string"?l.split(""):l,m=typeof t=="string"?t.split(""):t,r=o.length,i=Array.from({length:r},()=>"\u2B1C");if(r!==m.length)throw new Error("idioms must have the same length");const w=[];for(let u=0;u<r;u++){const h=o[u],g=m[u];h===g&&(i[u]="\u{1F7E9}",w.push(u))}const b=[];for(let u=0;u<r;u++){const h=o[u],g=m[u];if(h!==g){const p=m.indexOf(h);p!==-1&&!w.includes(p)&&!b.includes(p)&&(i[u]="\u{1F7E7}",b.push(p))}}return i};window.getIdiomStates=Y;const Q=t=>{if(t.some(r=>!!r.length&&r.every(i=>i==="\u{1F7E9}")))return"won";const o=t[t.length-1];return!!o.length&&o.every(r=>r!=="\u{1F7E9}")?"lost":null},V=()=>Array.from({length:$},()=>({v:Array.from({length:D},()=>""),s:!1})),G=(t,l,o,m=0)=>{var u;let r=l||new Set;r.add(t);let i=o||new Set;const w=t.split("");w.forEach(h=>i.add(h));let b=0;e:for(let h=0;h<y.length;h++){const g=w[(h+1)%D],p=y.find(({idiom:v})=>!r.has(v)&&v.includes(g));if(p){for(let v=0;v<p.idiom.length;v++)if(i.add(p.idiom[v]),i.size>=B)break e;r.add(p.idiom),b=0}else{if(b>=D+1)break e;b+=1}}if(i.size<B||r.size<$){const h=[...r][++m];if(h){const{passedIdioms:g,keys:p}=G(h,r,i,m);r=g,i=p}}if(i.size<B||r.size<$){const h=y[Math.floor(Math.random()*y.length)].idiom;if(h){const{passedIdioms:g,keys:p}=G(h,r,i,0);r=g,i=p}}if(i.size<B||r.size<$){const h=(u=y.find(g=>g.idiom===t))==null?void 0:u.id;console.error(h,{possibleIdioms:r.size,keySize:i.size,consecutiveFailures:b})}return{passedIdioms:r,keys:i}},U=t=>a("svg",A(M({viewBox:"0 0 20 20",fill:"currentColor"},t),{children:[e("title",{children:"\u25B6\uFE0F"}),e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})]})),Z=t=>a("svg",A(M({viewBox:"0 0 24 24"},t),{children:[e("title",{children:"\u2716\uFE0F"}),e("path",{fill:"currentColor",d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})]}));function ge(){var H;const[t,l]=S(y.find(n=>n.id===location.hash.slice(1))||y[0]);I(()=>{window.addEventListener("hashchange",()=>{l(y.find(n=>n.id===location.hash.slice(1))||y[0])})},[]);const[o,m]=S(((H=JSON.parse(localStorage.getItem(`cywd-${t.id}`)))==null?void 0:H.board)||V());I(()=>{const n=localStorage.getItem(`cywd-${t.id}`);m(n?JSON.parse(n).board:V())},[t.id]);const r=_(()=>o.map((n,s)=>n.s?Y(t.idiom,n.v):[]),[o]);I(()=>{o&&o.some(n=>n.v.some(s=>s))&&localStorage.setItem(`cywd-${t.id}`,JSON.stringify({board:o,gameState:Q(r)}))},[r]);const i=(o==null?void 0:o.findIndex(n=>n.s===!1))||0,[w,b]=S(!1),[u,h]=S(!1),[g,p]=S(!1),v=_(()=>{const{passedIdioms:n,keys:s}=G(t.idiom),c=[...n].map(d=>`${d} (${C(d)})`).sort((d,f)=>d.localeCompare(f,"zh"));return console.log(`POSSIBLE IDOMS [${t.id}] (${s.size} keys):
${c.map((d,f)=>`${f+1}. ${d}`).join(`
`)}

\u{1F6A8}SPOILER\u{1F6A8} Type 'ANSWER' to see the answer.
`),window.ANSWER=`${t.idiom} (${C(t.idiom)})`,[...s].sort((d,f)=>d.localeCompare(f,"zh"))},[t.idiom]),x=(n,s=!1)=>{if(!o[i]||k)return;const c=[...o];let d=c[i].v.findIndex(f=>f==="");s&&(d===-1?d=3:d--),d!==-1&&(c[i].v[d]=n,m(c))},O=new Set,T=new Set,N=new Set;o.forEach((n,s)=>{!n.s||n.v.forEach((c,d)=>{const f=r[s][d];f==="\u{1F7E9}"?O.add(c):f==="\u{1F7E7}"?T.add(c):f==="\u2B1C"&&N.add(c)})});const P=()=>{if(k)return;console.log("handleEnter"),b(!1);const n=o[i],s=n.v.join(""),c=pe.includes(s);c?(n.s=!0,m([...o])):setTimeout(()=>{b(!0)},10),console.log({currentIdiom:s,valid:c})},k=_(()=>Q(r),[r]);I(()=>{h(k==="won"?"won":k==="lost"?"lost":!1)},[k]);const K=()=>{if(k)return;const n=[...o],s=n[i];if(!s||s.s)return;let c=-1;for(let d=s.v.length-1;d>=0;d--)if(s.v[d]!==""){c=d;break}c!==-1&&(s.v[c]="",m(n))};I(()=>{document.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),n.stopPropagation())})},[]),I(()=>{const n=s=>{if(k||s.metaKey||s.ctrlKey||!s.key)return;const c=s.key.toLowerCase();if(c==="enter")s.preventDefault(),s.stopPropagation(),P();else if(c==="backspace")s.preventDefault(),K();else if(/^arrow(left|right)/i.test(c)){const f=[...o[i].v].reverse().find(F=>F!=="");if(f){const F=C(f)[0],E=v.filter(te=>C(te)[0]===F);if(E.length<=1)return;const R=E.indexOf(f),J=c==="arrowright"?E[(R+1)%E.length]:E[(R+E.length-1)%E.length];J&&x(J,!0)}}else{const d=v.find(f=>C(f)[0].localeCompare(c,"en",{sensitivity:"base"})===0);d&&(s.preventDefault(),x(d))}};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[v,i,k]);const L=location.origin+location.pathname+"#"+t.id,W=r.map(n=>n.join("")).join(`
`).trim(),ee=k==="won"?W.split(`
`).length:"X",z=`Chengyu Wordle [${t.id}] ${ee}/6

${W}

${L}`;return a(j,{children:[a("header",{children:[e("button",{type:"button",onClick:()=>{p(!0)},children:a("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e("title",{children:"\u2139\uFE0F"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),a("h1",{children:["Chengyu Wordle ",e("sup",{children:"beta"})]}),e("button",{type:"button",onClick:()=>{h(k||"play")},children:"Play"})]}),e("div",{id:"board",children:o.map((n,s)=>e("div",{className:`row ${i===s&&w?"error":""} ${i===s?"current":""}`,children:n.v.map((c,d)=>{var f;return e("div",{className:`letter ${c!=null?c:"lettered"} ${(f=r[s][d])!=null?f:""}`,children:a("ruby",{children:[c||e("span",{style:{opacity:0},children:"\u4E00"}),e("rp",{children:"("}),e("rt",{children:C(c)||e(j,{children:"\xA0"})}),e("rp",{children:")"})]})},d)})},s))}),e("div",{id:"keyboard",children:a("div",{class:"inner",children:[e("div",{class:"keys",children:v.map((n,s)=>e("button",{class:`${O.has(n)?"\u{1F7E9}":""} ${T.has(n)?"\u{1F7E7}":""} ${N.has(n)?"\u2B1C":""}`,type:"button",tabIndex:-1,onClick:()=>{x(n)},children:a("ruby",{children:[n,e("rp",{children:"("}),e("rt",{children:C(n)}),e("rp",{children:")"})]})}))}),a("div",{class:"row",children:[e("button",{type:"button",onClick:P,tabIndex:-1,children:"Enter"}),e("button",{type:"button",onClick:K,tabIndex:-1,children:e("svg",{height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7.07L2.4 12l4.66-7H22v14zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z"})})})]})]})}),a("div",{id:"modal",class:u?"appear":"",onClick:n=>{n.target===n.currentTarget&&h(null)},children:[e(Z,{height:"24",width:"24",class:"close",onClick:()=>{h(null)}}),a("div",{class:"content",children:[e("h2",{children:u==="won"?"\u{1F389}\u{1F389}\u{1F389}":u==="lost"?"\u{1F62D}\u{1F62D}\u{1F62D}":"\u{1F47E}\u{1F47E}\u{1F47E}"}),u==="play"&&a("a",{href:L,children:["\u{1F517} ",location.host+"/#"+t.id]}),/(won|lost)/i.test(u)&&a(j,{children:[a("p",{children:[e("b",{class:"answer",children:a("ruby",{children:[t.idiom,e("rp",{children:"("}),e("rt",{children:C(t.idiom)}),e("rp",{children:")"})]})}),e("br",{})," ",a("small",{children:[a("a",{href:L,children:["\u{1F517} ",t.id]}),"\xA0\xA0",e("a",{href:`https://cc-cedict.org/editor/editor.php?handler=QueryDictionary&querydictionary_search=${t.idiom}`,target:"_blank",children:"\u{1F4D6} CC-CEDICT"})]})]}),e("div",{class:"results",children:z}),a("button",{id:"share",onClick:async()=>{try{await navigator.share({text:z})}catch{try{await navigator.clipboard.writeText(z),alert("Copied results to clipboard")}catch{}}},children:["Share"," ",e("svg",{height:"16",width:"16",viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})})]})]}),a("p",{children:[a("button",{type:"button",onClick:()=>{if(confirm("Are you sure you want to start a new random game?")){const s=Math.round(Math.random()*(y.length-1)),c=y[s];location.hash=`#${c.id}`,h(null)}},children:[e(U,{width:20,height:20})," Random"]})," ",a("button",{type:"button",onClick:()=>{const n=prompt("Enter idiom ID:");if(n){const s=y.find(c=>c.id===n);s?(location.hash=`#${s.id}`,h(null)):alert("Invalid idiom ID")}},children:[e(U,{width:20,height:20})," Choose"]})]})]})]}),a("div",{id:"info-modal",class:g?"appear":"",children:[e(Z,{height:"24",width:"24",class:"close",onClick:()=>{p(!1)}}),a("div",{class:"content",children:[e("h2",{children:"How to play"}),e("p",{children:"Guess the idiom in 6 tries."}),e("p",{children:"Each guess must be a valid 4-letter idiom. Hit the enter button to submit."}),e("p",{children:"After each guess, the color of the tiles will change to show how close your guess was to the idiom."}),a("ul",{children:[e("li",{children:"\u{1F7E9}\u2B1C\u2B1C\u2B1C Green = correct spot"}),e("li",{children:"\u2B1C\u{1F7E7}\u2B1C\u2B1C Yellow = wrong spot"}),a("li",{children:["\u2B1C\u2B1C",e("span",{style:{opacity:.5},children:"\u2B1B"}),"\u2B1C Gray = not in any spot"]})]}),e("h2",{children:"About"}),a("p",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/",target:"_blank",children:"Built"})," ","by"," ",e("a",{href:"https://cheeaun.com",target:"_blank",children:"Chee Aun"}),"."," ",e("a",{href:"https://www.powerlanguage.co.uk/wordle/",target:"_blank",children:"Wordle"})," ","\xA9\uFE0F"," ",e("a",{href:"https://powerlanguage.co.uk/",target:"_blank",children:"Josh Wardle"}),"."]}),e("h2",{children:"Feedback channels"}),a("ul",{children:[e("li",{children:e("a",{href:"https://t.me/+ykuhfiImLd1kNjk1",target:"_blank",children:"Telegram group"})}),a("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/discussions",target:"_blank",children:"GitHub Discussions"}),"(for developers)"]}),a("li",{children:[e("a",{href:"https://github.com/cheeaun/chengyu-wordle/issues",target:"_blank",children:"GitHub Issues"})," ","(for bugs)"]}),e("li",{children:e("a",{href:"https://twitter.com/cheeaun",target:"_blank",children:"@cheeaun on Twitter"})}),e("li",{children:e("a",{href:"https://t.me/cheeaun",target:"_blank",children:"@cheeaun on Telegram"})})]})]})]})]})}he(e(ge,{}),document.getElementById("app"));
//# sourceMappingURL=index.66d3aaa6.js.map
